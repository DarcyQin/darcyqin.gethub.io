---
layout: post
title:  "EM算法"
date:   2019-06-20 23:30
categories: algorithm
tags: algorithm, ML
excerpt: 
mathjax: true
---

* content
{:toc}


## 凸函数
开始EM算法前，我们先讨论凸函数。连续函数的一阶导数就是相应的切线斜率。一阶导数大于0，则递增；一阶倒数小于0，则递减；一阶导数等于0，则不增不减。 而二阶导数可以反映图象的凹凸。二阶导数大于0，图象为凹；二阶导数小于0，图象为凸；二阶导数等于0，不凹不凸。

现设一函数f(x)，在该函数定义域的凸区间内任取两点$x_1$,$x_2$, 其中$x_1<x_2$,设一点$x=q_1x_1+q_2x_2$,($q_1$,$q_2>0$且$q_1+q_2=1$),那么该点必包含于$x_1$,$x_2$之间。

![image03](https://darcyqin.github.io/img/tufunc.png)

图中包含点$A_1(x_1,x_2)$、$A_2(x_2,x_2)$,$A(x,f(x))$,先构建线性函数两点式，代入$A_1(x_1,x_2)$、$A_2(x_2,x_2)$两点，再代入B点的横坐标，得到其纵坐标：

$$y=\frac{x_2-x}{x_2-x_1}y_1+\frac{x-x_1}{x_2-x_1}y_2$$

同时利用$x=q_1x_1+q_2x_2$可以得：


$$q_1=\frac{x_2-x}{x_2-x_1}$$

$$q_2=\frac{x-x_1}{x_2-x_1}$$

所以B的纵坐标是：

$$y=q_1f(x_1)+q_2f(x_2)$$

结合上图，显然：

$$y_B≥y_A$$

$$=> q_1f(x_1)+q_2f(x_2)≥f(q_1x_1+q_2x_2)$$

且当$x_1 -> x_2$时，可以等号成立。

总结下：   
在区间X上，有定义而且连续的函数$f(x)$叫做凸函数（往下凸），如果对于区间x中的任何两点$x_1$和$x_2(x_2>=x_1)$有不等式：

$$f(q_1x_1+q_2x_2) ≤q_1f(x_1)+q_2f(x_2)$$

同理，当函数为凹函数是：

$$f(q_1x_1+q_2x_2) ≥q_1f(x_1)+q_2f(x_2)$$


## Jensen不等式
刚刚我们已经证明的凸函数的代数定义：

$$q_1f(x_1)+q_2f(x_2)≥f(q_1x_1+q_2x_2)$$

将其一般化，便容易推出：

$$f(q_1x_1+q_2x_2+...+q_nx_n)≤q_1f(x_1)+q_2f(x_2)+...+q_nf(x_n)$$

$$(q_1,...,q_n>0,q_1+...+q_n=1)$$

将形式更加简化得：

$$f(\frac{\sum_{i=1}^np_ix_i}{\sum_{i=1}^np_i})≤\frac{\sum_{i=1}^np_if(x_i)}{\sum_{i=1}^np_i}$$


